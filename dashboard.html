<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MyTradingHub Dashboard</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f4f6fa;
  }
  .sidebar {
    width: 250px;
    background: #fff;
    height: 100vh;
    position: fixed;
    overflow-y: auto;
    border-right: 1px solid #ddd;
  }
  .main-content {
    margin-left: 250px;
    padding: 20px;
  }
  .account-dropdown {
    position: absolute;
    right: 20px;
    top: 20px;
    cursor: pointer;
    z-index: 1000;
  }
  .dropdown-menu {
    right: 0;
    left: auto;
  }
  .trade-panel {
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
  }
  .chart-container {
    background: white;
    border-radius: 8px;
    padding: 10px;
    margin-bottom: 20px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
  }
  .list-group-item {
    cursor: pointer;
  }
</style>
</head>
<body>

<!-- Sidebar with currency pairs -->
<div class="sidebar p-3">
  <h5>Forex Pairs</h5>
  <ul class="list-group" id="pairList">
    <li class="list-group-item" data-symbol="OANDA:XAUUSD">XAUUSD</li>
    <li class="list-group-item" data-symbol="OANDA:EURUSD">EURUSD</li>
    <li class="list-group-item" data-symbol="OANDA:GBPUSD">GBPUSD</li>
    <li class="list-group-item" data-symbol="OANDA:BTCUSD">BTCUSD</li>
    <li class="list-group-item" data-symbol="OANDA:ETHUSD">ETHUSD</li>
    <li class="list-group-item" data-symbol="OANDA:USDJPY">USDJPY</li>
    <li class="list-group-item" data-symbol="OANDA:NZDUSD">NZDUSD</li>
    <li class="list-group-item" data-symbol="OANDA:USDCAD">USDCAD</li>
  </ul>
</div>

<!-- Main content area -->
<div class="main-content">
  <div class="d-flex justify-content-end position-relative">
    <div class="dropdown account-dropdown">
      <button class="btn btn-primary dropdown-toggle" type="button" id="accountDropdownBtn" data-bs-toggle="dropdown" aria-expanded="false">
        <span id="userEmail">user@example.com</span> | $<span id="userBalance">0.00</span>
      </button>
      <ul class="dropdown-menu" aria-labelledby="accountDropdownBtn">
        <li><a class="dropdown-item" href="deposit.html">Deposit</a></li>
        <li><a class="dropdown-item" href="withdrawal.html">Withdrawal</a></li>
        <li><a class="dropdown-item" href="wallet.html">Wallet</a></li>
        <li><a class="dropdown-item" href="verify.html">Real Name Verification</a></li>
        <li><a class="dropdown-item" href="invite.html">Invite Friends</a></li>
        <li><a class="dropdown-item" href="change-password.html">Change Password</a></li>
        <li><a class="dropdown-item" href="announcement.html">Announcement</a></li>
        <li><a class="dropdown-item" href="support.html">Online Service</a></li>
        <li><hr class="dropdown-divider"></li>
        <li><a class="dropdown-item text-danger" href="logout.html">Logout</a></li>
      </ul>
    </div>
  </div>

  <!-- Chart Area -->
  <div class="chart-container">
    <iframe
      id="chartFrame"
      src="https://www.tradingview.com/chart/?symbol=OANDA:XAUUSD"
      width="100%"
      height="400"
      frameborder="0"
      allowtransparency="true"
      scrolling="no"
    ></iframe>
  </div>

  <!-- Trade panel -->
  <div class="trade-panel">
    <h5 id="pairTitle">XAUUSD</h5>
    <p><strong>Market Price:</strong> <span id="marketPrice">Loading...</span></p>
    <form id="tradeForm">
      <div class="row g-3">
        <div class="col-md-3">
          <label>Multiplier</label>
          <input type="number" class="form-control" id="multiplier" value="100" min="1" />
        </div>
        <div class="col-md-3">
          <label>Set Loss</label>
          <input type="number" class="form-control" id="setLoss" value="0" min="0" />
        </div>
        <div class="col-md-3">
          <label>Take Profit</label>
          <input type="number" class="form-control" id="takeProfit" value="0" min="0" />
        </div>
        <div class="col-md-3">
          <label>Lots (Step: 0.01)</label>
          <input type="number" step="0.01" class="form-control" id="lots" value="1" min="0.01" />
        </div>
      </div>
      <div class="mt-3 d-flex justify-content-between">
        <button type="submit" class="btn btn-success w-25" id="buyBtn">Buy</button>
        <button type="submit" class="btn btn-danger w-25" id="sellBtn">Sell</button>
      </div>
    </form>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  $(document).ready(function() {
    // Load user email and balance from localStorage
    const userEmail = localStorage.getItem('userEmail') || 'user@example.com';
    const userBalance = parseFloat(localStorage.getItem('userBalance')) || 0;

    $('#userEmail').text(userEmail);
    $('#userBalance').text(userBalance.toFixed(2));

    // Currency pair selection
    $('#pairList li').on('click', function() {
      const symbol = $(this).data('symbol');
      const pair = $(this).text();
      $('#chartFrame').attr('src', `https://www.tradingview.com/chart/?symbol=${symbol}`);
      $('#pairTitle').text(pair);
      $('#marketPrice').text('Loading...');
      fetchPrice(symbol);
    });

    // Fetch market price from Finnhub or fallback (simplified)
    function fetchPrice(symbol) {
      // Example: Use your API key and logic here to fetch real price
      // For demo, just show fake price after 1 sec
      setTimeout(() => {
        $('#marketPrice').text('$' + (Math.random() * 10000).toFixed(2));
      }, 1000);
    }

    // Initial fetch price
    fetchPrice('OANDA:XAUUSD');

    // Trade form submit - Buy or Sell
    $('#tradeForm').on('submit', function(e) {
      e.preventDefault();
      const action = $(document.activeElement).attr('id'); // buyBtn or sellBtn
      const lots = parseFloat($('#lots').val());
      const multiplier = parseInt($('#multiplier').val());
      const setLoss = parseFloat($('#setLoss').val());
      const takeProfit = parseFloat($('#takeProfit').val());
      const pair = $('#pairTitle').text();
      const price = parseFloat($('#marketPrice').text().replace('$', ''));

      if (isNaN(price) || price === 0) {
        alert('Market price not available');
        return;
      }
      // Example profit/loss calculation
      const margin = lots * multiplier;
      // Show a simple alert or update your trades list here
      alert(`${action.toUpperCase()} order placed for ${lots} lots of ${pair} at $${price} with margin ${margin}`);
      // You can extend to save trade history and update balance here
    });
  });
</script>
</body>
</html>
